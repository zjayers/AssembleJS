#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Get the current command that initiated this commit
COMMAND=$(ps -ocommand= -p $PPID)

# If git commit was run directly (not through npm run commit)
if echo "$COMMAND" | grep -E 'git commit|-c|--reedit-message|--reuse-message|-F|--file|--fixup|--squash'; then
  if [ -z "$SKIP_COMMITIZEN" ]; then
    echo "‚ùå Direct git commit is not allowed! Please use 'npm run commit' instead."
    echo "   This ensures standardized commit messages."
    echo ""
    echo "   If you absolutely need to bypass this check, set SKIP_COMMITIZEN=1 before committing:"
    echo "   SKIP_COMMITIZEN=1 git commit ..."
    exit 1
  fi
fi

exec < /dev/tty && npx cz --hook || true